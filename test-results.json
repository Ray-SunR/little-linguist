
> raiden@0.1.0 test
> vitest run --reporter=json

[dotenv@17.2.3] injecting env (16) from .env.development.local -- tip: ğŸ“¡ add observability to secrets: https://dotenvx.com/ops

ğŸš€ Global Setup: Ensuring Supabase is running...
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸ”§ Development Tools                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Studio  â”‚ http://127.0.0.1:54323     â”‚
â”‚ Mailpit â”‚ http://127.0.0.1:54324     â”‚
â”‚ MCP     â”‚ http://127.0.0.1:54321/mcp â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸŒ APIs                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Project URL â”‚ http://127.0.0.1:54321            â”‚
â”‚ REST        â”‚ http://127.0.0.1:54321/rest/v1    â”‚
â”‚ GraphQL     â”‚ http://127.0.0.1:54321/graphql/v1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ â› Database                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ URL â”‚ postgresql://postgres:postgres@127.0.0.1:54322/postgres â”‚
â•°â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸ”‘ Authentication Keys                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Publishable â”‚ sb_publishable_ACJWlzQHlZjBrEguHvfOxg_3BJgxAaH â”‚
â”‚ Secret      â”‚ sb_secret_N7UND0UgjKTVK-Uodkm0Hg_xSvEMPvz      â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸ“¦ Storage (S3)                                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ URL        â”‚ http://127.0.0.1:54321/storage/v1/s3                             â”‚
â”‚ Access Key â”‚ 625729a08b95bf1b7ff351a663f3a23c                                 â”‚
â”‚ Secret Key â”‚ 850181e4652dd023b7a98c58ae0d2d34bd487ee0cc3254aed6eda37307425907 â”‚
â”‚ Region     â”‚ local                                                            â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

âœ… Supabase is ready.
{"numTotalTestSuites":75,"numPassedTestSuites":73,"numFailedTestSuites":2,"numPendingTestSuites":0,"numTotalTests":126,"numPassedTests":118,"numFailedTests":8,"numPendingTests":0,"numTodoTests":0,"startTime":1769146245054,"success":false,"testResults":[{"assertionResults":[],"startTime":1769146245054,"endTime":1769146245054,"status":"failed","message":"Playwright Test did not expect test() to be called here.\nMost common reasons include:\n- You are calling test() in a configuration file.\n- You are calling test() in a file that is imported by the configuration file.\n- You have two different versions of @playwright/test. This usually happens\n  when one of the dependencies in your package.json depends on @playwright/test.","name":"/Users/renchen/Work/github/raiden/e2e/authenticated-story-maker.spec.ts"},{"assertionResults":[],"startTime":1769146245054,"endTime":1769146245054,"status":"failed","message":"Playwright Test did not expect test() to be called here.\nMost common reasons include:\n- You are calling test() in a configuration file.\n- You are calling test() in a file that is imported by the configuration file.\n- You have two different versions of @playwright/test. This usually happens\n  when one of the dependencies in your package.json depends on @playwright/test.","name":"/Users/renchen/Work/github/raiden/e2e/guest-story-maker.spec.ts"},{"assertionResults":[{"ancestorTitles":["","Rewards Integration Flow"],"fullName":" Rewards Integration Flow should complete a full reward cycle for a book","status":"passed","title":"should complete a full reward cycle for a book","duration":0,"failureMessages":[]},{"ancestorTitles":["","Rewards Integration Flow"],"fullName":" Rewards Integration Flow should handle mission rewards correctly","status":"passed","title":"should handle mission rewards correctly","duration":1,"failureMessages":[]},{"ancestorTitles":["","Rewards Integration Flow"],"fullName":" Rewards Integration Flow should handle multiple activities contributing to streak","status":"passed","title":"should handle multiple activities contributing to streak","duration":0,"failureMessages":[]}],"startTime":1769146248512,"endTime":1769146248513,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/rewards.test.ts"},{"assertionResults":[{"ancestorTitles":["","AssetCache"],"fullName":" AssetCache should return signedUrl if window is undefined","status":"passed","title":"should return signedUrl if window is undefined","duration":1,"failureMessages":[]},{"ancestorTitles":["","AssetCache"],"fullName":" AssetCache should fetch and cache asset on miss","status":"passed","title":"should fetch and cache asset on miss","duration":1,"failureMessages":[]}],"startTime":1769146251821,"endTime":1769146251823,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/unit/asset-cache.test.ts"},{"assertionResults":[{"ancestorTitles":["","TextChunker"],"fullName":" TextChunker should chunk text and verify word counts","status":"passed","title":"should chunk text and verify word counts","duration":0,"failureMessages":[]}],"startTime":1769146251841,"endTime":1769146251841,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/unit/text-chunker.test.ts"},{"assertionResults":[{"ancestorTitles":["","Token Adapter"],"fullName":" Token Adapter should convert tokens to word tokens with punctuation","status":"passed","title":"should convert tokens to word tokens with punctuation","duration":0,"failureMessages":[]}],"startTime":1769146251832,"endTime":1769146251832,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/unit/token-adapter.test.ts"},{"assertionResults":[{"ancestorTitles":["","Tokenizer"],"fullName":" Tokenizer should tokenize basic sentences correctly","status":"passed","title":"should tokenize basic sentences correctly","duration":0,"failureMessages":[]},{"ancestorTitles":["","Tokenizer"],"fullName":" Tokenizer should handle contractions","status":"passed","title":"should handle contractions","duration":0,"failureMessages":[]},{"ancestorTitles":["","Tokenizer"],"fullName":" Tokenizer should handle hyphenated words","status":"passed","title":"should handle hyphenated words","duration":0,"failureMessages":[]},{"ancestorTitles":["","Tokenizer"],"fullName":" Tokenizer should handle punctuation and spaces","status":"passed","title":"should handle punctuation and spaces","duration":0,"failureMessages":[]},{"ancestorTitles":["","Tokenizer"],"fullName":" Tokenizer should handle smart quotes","status":"passed","title":"should handle smart quotes","duration":0,"failureMessages":[]},{"ancestorTitles":["","Tokenizer"],"fullName":" Tokenizer should reconstruct text exactly","status":"passed","title":"should reconstruct text exactly","duration":0,"failureMessages":[]}],"startTime":1769146251797,"endTime":1769146251797,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/unit/tokenizer.test.ts"},{"assertionResults":[{"ancestorTitles":["","UUID Utilities"],"fullName":" UUID Utilities should generate a valid UUID","status":"passed","title":"should generate a valid UUID","duration":0,"failureMessages":[]},{"ancestorTitles":["","UUID Utilities"],"fullName":" UUID Utilities should fall back to Math.random if crypto is missing","status":"passed","title":"should fall back to Math.random if crypto is missing","duration":0,"failureMessages":[]}],"startTime":1769146251844,"endTime":1769146251844,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/unit/uuid.test.ts"},{"assertionResults":[{"ancestorTitles":["","Tutorial Logic"],"fullName":" Tutorial Logic all steps have unique stable ids","status":"passed","title":"all steps have unique stable ids","duration":0,"failureMessages":[]},{"ancestorTitles":["","Tutorial Logic"],"fullName":" Tutorial Logic all steps have targetId or dataTourTarget","status":"passed","title":"all steps have targetId or dataTourTarget","duration":0,"failureMessages":[]},{"ancestorTitles":["","Tutorial Logic"],"fullName":" Tutorial Logic story-maker-nav step points to the correct route","status":"passed","title":"story-maker-nav step points to the correct route","duration":0,"failureMessages":[]},{"ancestorTitles":["","Tutorial Logic"],"fullName":" Tutorial Logic requiresAuth steps have actionRequired where intended","status":"passed","title":"requiresAuth steps have actionRequired where intended","duration":0,"failureMessages":[]}],"startTime":1769146251829,"endTime":1769146251829,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/components/tutorial/__tests__/tutorial-logic.test.ts"},{"assertionResults":[{"ancestorTitles":["","BookRepository Integration"],"fullName":" BookRepository Integration should fetch available books","status":"passed","title":"should fetch available books","duration":3,"failureMessages":[]},{"ancestorTitles":["","BookRepository Integration"],"fullName":" BookRepository Integration should fetch books with covers and limit filter","status":"passed","title":"should fetch books with covers and limit filter","duration":5,"failureMessages":[]},{"ancestorTitles":["","BookRepository Integration"],"fullName":" BookRepository Integration should fetch specific book by id","status":"passed","title":"should fetch specific book by id","duration":12,"failureMessages":[]},{"ancestorTitles":["","BookRepository Integration"],"fullName":" BookRepository Integration should return null for non-existent book","status":"passed","title":"should return null for non-existent book","duration":2,"failureMessages":[]},{"ancestorTitles":["","BookRepository Integration"],"fullName":" BookRepository Integration should search books by embedding similarity","status":"failed","title":"should search books by embedding similarity","duration":9,"failureMessages":["expected 0 to be greater than 0"],"location":{"line":69,"column":32}},{"ancestorTitles":["","BookRepository Integration"],"fullName":" BookRepository Integration should recommend books for child","status":"passed","title":"should recommend books for child","duration":17,"failureMessages":[]}],"startTime":1769146249618,"endTime":1769146249666,"status":"failed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/repositories/books.test.ts"},{"assertionResults":[{"ancestorTitles":["","StoryRepository Integration"],"fullName":" StoryRepository Integration should create and fetch a story","status":"passed","title":"should create and fetch a story","duration":4,"failureMessages":[]},{"ancestorTitles":["","StoryRepository Integration"],"fullName":" StoryRepository Integration should update story status","status":"passed","title":"should update story status","duration":6,"failureMessages":[]},{"ancestorTitles":["","StoryRepository Integration"],"fullName":" StoryRepository Integration should handle non-existent story id","status":"passed","title":"should handle non-existent story id","duration":2,"failureMessages":[]}],"startTime":1769146251346,"endTime":1769146251358,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/repositories/stories.test.ts"},{"assertionResults":[{"ancestorTitles":["","Book Detail API Integration"],"fullName":" Book Detail API Integration should fetch book by id","status":"passed","title":"should fetch book by id","duration":14,"failureMessages":[]},{"ancestorTitles":["","Book Detail API Integration"],"fullName":" Book Detail API Integration should return 404 for non-existent book","status":"passed","title":"should return 404 for non-existent book","duration":4,"failureMessages":[]},{"ancestorTitles":["","Book Detail API Integration"],"fullName":" Book Detail API Integration should delete own book","status":"passed","title":"should delete own book","duration":19,"failureMessages":[]},{"ancestorTitles":["","Book Detail API Integration"],"fullName":" Book Detail API Integration should fail to delete someone elses book","status":"passed","title":"should fail to delete someone elses book","duration":109,"failureMessages":[]}],"startTime":1769146249205,"endTime":1769146249351,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/api/book-detail.test.ts"},{"assertionResults":[{"ancestorTitles":["","Books API Integration"],"fullName":" Books API Integration should return exactly 6 books for unauthenticated user (guest limit)","status":"passed","title":"should return exactly 6 books for unauthenticated user (guest limit)","duration":6,"failureMessages":[]},{"ancestorTitles":["","Books API Integration"],"fullName":" Books API Integration should filter books by category","status":"passed","title":"should filter books by category","duration":6,"failureMessages":[]},{"ancestorTitles":["","Books API Integration"],"fullName":" Books API Integration should respect limit and offset for authenticated user","status":"passed","title":"should respect limit and offset for authenticated user","duration":7,"failureMessages":[]}],"startTime":1769146251634,"endTime":1769146251653,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/api/books.test.ts"},{"assertionResults":[{"ancestorTitles":["","Guest Limit Use Cases"],"fullName":" Guest Limit Use Cases should limit library books to exactly 6 for guests","status":"passed","title":"should limit library books to exactly 6 for guests","duration":7,"failureMessages":[]},{"ancestorTitles":["","Guest Limit Use Cases"],"fullName":" Guest Limit Use Cases should allow limited word insights for guests","status":"passed","title":"should allow limited word insights for guests","duration":2,"failureMessages":[]},{"ancestorTitles":["","Guest Limit Use Cases"],"fullName":" Guest Limit Use Cases should forbid story generation for guests","status":"passed","title":"should forbid story generation for guests","duration":1,"failureMessages":[]},{"ancestorTitles":["","Guest Limit Use Cases"],"fullName":" Guest Limit Use Cases should return zero quotas for restricted guest features","status":"passed","title":"should return zero quotas for restricted guest features","duration":2,"failureMessages":[]}],"startTime":1769146251197,"endTime":1769146251209,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/api/guest-limits.test.ts"},{"assertionResults":[{"ancestorTitles":["","Image Retry API Integration"],"fullName":" Image Retry API Integration should trigger image retry","status":"passed","title":"should trigger image retry","duration":17,"failureMessages":[]},{"ancestorTitles":["","Image Retry API Integration"],"fullName":" Image Retry API Integration should fail if max retries reached","status":"passed","title":"should fail if max retries reached","duration":6,"failureMessages":[]}],"startTime":1769146248665,"endTime":1769146248688,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/api/image-retry.test.ts"},{"assertionResults":[{"ancestorTitles":["","Magic Sentence API Integration"],"fullName":" Magic Sentence API Integration should generate magic sentence via API","status":"failed","title":"should generate magic sentence via API","duration":27,"failureMessages":["expected 500 to be 200 // Object.is equality"],"location":{"line":80,"column":28}},{"ancestorTitles":["","Magic Sentence API Integration"],"fullName":" Magic Sentence API Integration should fetch magic sentence history via API","status":"failed","title":"should fetch magic sentence history via API","duration":4,"failureMessages":["expected 0 to be greater than 0"],"location":{"line":108,"column":29}}],"startTime":1769146248840,"endTime":1769146248871,"status":"failed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/api/magic-sentence-api.test.ts"},{"assertionResults":[{"ancestorTitles":["","All-Progress API Integration"],"fullName":" All-Progress API Integration should fetch all progress for user","status":"passed","title":"should fetch all progress for user","duration":6,"failureMessages":[]},{"ancestorTitles":["","All-Progress API Integration"],"fullName":" All-Progress API Integration should save progress via POST","status":"passed","title":"should save progress via POST","duration":9,"failureMessages":[]}],"startTime":1769146250712,"endTime":1769146250727,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/api/progress-all.test.ts"},{"assertionResults":[{"ancestorTitles":["","Remaining API Routes Integration"],"fullName":" Remaining API Routes Integration should fetch usage for a user","status":"passed","title":"should fetch usage for a user","duration":12,"failureMessages":[]},{"ancestorTitles":["","Remaining API Routes Integration"],"fullName":" Remaining API Routes Integration should save and fetch book progress","status":"passed","title":"should save and fetch book progress","duration":15,"failureMessages":[]},{"ancestorTitles":["","Remaining API Routes Integration"],"fullName":" Remaining API Routes Integration should add, fetch, and delete words","status":"passed","title":"should add, fetch, and delete words","duration":33,"failureMessages":[]},{"ancestorTitles":["","Remaining API Routes Integration"],"fullName":" Remaining API Routes Integration should generate word insight (cache miss)","status":"passed","title":"should generate word insight (cache miss)","duration":30,"failureMessages":[]}],"startTime":1769146246630,"endTime":1769146246720,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/api/remaining-routes.test.ts"},{"assertionResults":[{"ancestorTitles":["","Rewards System Integration"],"fullName":" Rewards System Integration should grant XP when a book is opened for the first time today","status":"passed","title":"should grant XP when a book is opened for the first time today","duration":13,"failureMessages":[]},{"ancestorTitles":["","Rewards System Integration"],"fullName":" Rewards System Integration should not grant duplicate XP when opening the same book again today","status":"passed","title":"should not grant duplicate XP when opening the same book again today","duration":8,"failureMessages":[]},{"ancestorTitles":["","Rewards System Integration"],"fullName":" Rewards System Integration should grant XP when a book is completed","status":"passed","title":"should grant XP when a book is completed","duration":12,"failureMessages":[]}],"startTime":1769146248475,"endTime":1769146248508,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/api/rewards-flow.test.ts"},{"assertionResults":[{"ancestorTitles":["","Search and Recommendations API Integration"],"fullName":" Search and Recommendations API Integration should search books","status":"failed","title":"should search books","duration":6,"failureMessages":["expected 0 to be greater than 0"],"location":{"line":84,"column":29}},{"ancestorTitles":["","Search and Recommendations API Integration"],"fullName":" Search and Recommendations API Integration should get recommendations for child","status":"passed","title":"should get recommendations for child","duration":10,"failureMessages":[]},{"ancestorTitles":["","Search and Recommendations API Integration"],"fullName":" Search and Recommendations API Integration should toggle book favorite","status":"passed","title":"should toggle book favorite","duration":13,"failureMessages":[]}],"startTime":1769146248281,"endTime":1769146248310,"status":"failed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/api/search-recs.test.ts"},{"assertionResults":[{"ancestorTitles":["","Story API Integration"],"fullName":" Story API Integration should generate a story for an authenticated user","status":"failed","title":"should generate a story for an authenticated user","duration":1062,"failureMessages":["expected 'TestKid\\'s Magic Staff' to be 'Test Story' // Object.is equality"],"location":{"line":125,"column":28}},{"ancestorTitles":["","Story API Integration"],"fullName":" Story API Integration should fail without childId","status":"passed","title":"should fail without childId","duration":21,"failureMessages":[]}],"startTime":1769146246902,"endTime":1769146247985,"status":"failed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/api/story.test.ts"},{"assertionResults":[{"ancestorTitles":["","AuditService Integration"],"fullName":" AuditService Integration should log an action successfully","status":"passed","title":"should log an action successfully","duration":5,"failureMessages":[]},{"ancestorTitles":["","AuditService Integration"],"fullName":" AuditService Integration should respect cooldown and not log duplicates","status":"passed","title":"should respect cooldown and not log duplicates","duration":4,"failureMessages":[]}],"startTime":1769146251785,"endTime":1769146251794,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/services/audit.test.ts"},{"assertionResults":[{"ancestorTitles":["","MagicSentenceService Integration"],"fullName":" MagicSentenceService Integration should generate and store a magic sentence","status":"failed","title":"should generate and store a magic sentence","duration":27,"failureMessages":["Bucket not found"]},{"ancestorTitles":["","MagicSentenceService Integration"],"fullName":" MagicSentenceService Integration should fetch history","status":"failed","title":"should fetch history","duration":2,"failureMessages":["expected 0 to be greater than 0"],"location":{"line":86,"column":32}},{"ancestorTitles":["","MagicSentenceService Integration"],"fullName":" MagicSentenceService Integration should throw forbidden for other users child","status":"passed","title":"should throw forbidden for other users child","duration":2,"failureMessages":[]}],"startTime":1769146249804,"endTime":1769146249835,"status":"failed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/services/magic-sentence.test.ts"},{"assertionResults":[{"ancestorTitles":["","Narrative Services Integration"],"fullName":" Narrative Services Integration should annotate text via NarrativeDirector","status":"passed","title":"should annotate text via NarrativeDirector","duration":0,"failureMessages":[]},{"ancestorTitles":["","Narrative Services Integration"],"fullName":" Narrative Services Integration should generate embeddings via BedrockEmbeddingService","status":"passed","title":"should generate embeddings via BedrockEmbeddingService","duration":1,"failureMessages":[]}],"startTime":1769146251808,"endTime":1769146251809,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/services/narrative.test.ts"},{"assertionResults":[{"ancestorTitles":["","NovaStoryService Integration"],"fullName":" NovaStoryService Integration should generate story via Nova","status":"passed","title":"should generate story via Nova","duration":0,"failureMessages":[]},{"ancestorTitles":["","NovaStoryService Integration"],"fullName":" NovaStoryService Integration should generate image via Nova","status":"passed","title":"should generate image via Nova","duration":0,"failureMessages":[]},{"ancestorTitles":["","NovaStoryService Integration"],"fullName":" NovaStoryService Integration should generate cover prompt via Nova","status":"passed","title":"should generate cover prompt via Nova","duration":0,"failureMessages":[]}],"startTime":1769146250736,"endTime":1769146250736,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/services/nova.test.ts"},{"assertionResults":[{"ancestorTitles":["","StabilityStoryService Integration"],"fullName":" StabilityStoryService Integration should generate image via Stability","status":"passed","title":"should generate image via Stability","duration":0,"failureMessages":[]}],"startTime":1769146251838,"endTime":1769146251838,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/services/stability.test.ts"},{"assertionResults":[{"ancestorTitles":["","UsageService Integration"],"fullName":" UsageService Integration should resolve quota for free user","status":"passed","title":"should resolve quota for free user","duration":3,"failureMessages":[]},{"ancestorTitles":["","UsageService Integration"],"fullName":" UsageService Integration should reserve and consume credits","status":"passed","title":"should reserve and consume credits","duration":8,"failureMessages":[]},{"ancestorTitles":["","UsageService Integration"],"fullName":" UsageService Integration should fail when limit reached","status":"passed","title":"should fail when limit reached","duration":7,"failureMessages":[]},{"ancestorTitles":["","UsageService Integration"],"fullName":" UsageService Integration should refund credits","status":"passed","title":"should refund credits","duration":8,"failureMessages":[]},{"ancestorTitles":["","UsageService Integration"],"fullName":" UsageService Integration should record point transactions in the database","status":"passed","title":"should record point transactions in the database","duration":5,"failureMessages":[]}],"startTime":1769146249005,"endTime":1769146249036,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/integration/services/usage.test.ts"},{"assertionResults":[{"ancestorTitles":["","Guest Avatar Claim"],"fullName":" Guest Avatar Claim claimGuestAvatar should return new path on success","status":"passed","title":"claimGuestAvatar should return new path on success","duration":0,"failureMessages":[]},{"ancestorTitles":["","Guest Avatar Claim"],"fullName":" Guest Avatar Claim claimGuestAvatar should return null for non-guest path","status":"passed","title":"claimGuestAvatar should return null for non-guest path","duration":0,"failureMessages":[]},{"ancestorTitles":["","Guest Avatar Claim"],"fullName":" Guest Avatar Claim createChildProfile should trigger claim for guest paths","status":"passed","title":"createChildProfile should trigger claim for guest paths","duration":1,"failureMessages":[]}],"startTime":1769146251001,"endTime":1769146251002,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/tests/unit/actions/profiles.test.ts"},{"assertionResults":[{"ancestorTitles":["","BookRepository","getAvailableBooks"],"fullName":" BookRepository getAvailableBooks should fetch books filtered by user if userId is provided","status":"passed","title":"should fetch books filtered by user if userId is provided","duration":1,"failureMessages":[]},{"ancestorTitles":["","BookRepository","getAvailableBooks"],"fullName":" BookRepository getAvailableBooks should fetch public books only if no userId provided","status":"passed","title":"should fetch public books only if no userId provided","duration":0,"failureMessages":[]},{"ancestorTitles":["","BookRepository","getBookById"],"fullName":" BookRepository getBookById should fetch book by UUID","status":"passed","title":"should fetch book by UUID","duration":1,"failureMessages":[]},{"ancestorTitles":["","BookRepository","getBookById"],"fullName":" BookRepository getBookById should return null if book not found","status":"passed","title":"should return null if book not found","duration":0,"failureMessages":[]},{"ancestorTitles":["","BookRepository","createBook"],"fullName":" BookRepository createBook should insert a new book","status":"passed","title":"should insert a new book","duration":0,"failureMessages":[]},{"ancestorTitles":["","BookRepository","saveProgress"],"fullName":" BookRepository saveProgress should preserve is_completed: true if database already has it as true","status":"passed","title":"should preserve is_completed: true if database already has it as true","duration":1,"failureMessages":[]},{"ancestorTitles":["","BookRepository","saveProgress"],"fullName":" BookRepository saveProgress should update to is_completed: true if requested and database says false","status":"passed","title":"should update to is_completed: true if requested and database says false","duration":0,"failureMessages":[]}],"startTime":1769146246334,"endTime":1769146246337,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/lib/core/books/__tests__/repository.test.ts"},{"assertionResults":[{"ancestorTitles":["","StoryRepository"],"fullName":" StoryRepository should get story by ID","status":"passed","title":"should get story by ID","duration":0,"failureMessages":[]},{"ancestorTitles":["","StoryRepository"],"fullName":" StoryRepository should get story by ID and userId","status":"passed","title":"should get story by ID and userId","duration":0,"failureMessages":[]},{"ancestorTitles":["","StoryRepository"],"fullName":" StoryRepository should return null if story not found (PGRST116)","status":"passed","title":"should return null if story not found (PGRST116)","duration":0,"failureMessages":[]},{"ancestorTitles":["","StoryRepository"],"fullName":" StoryRepository should throw error if get fails with other error","status":"passed","title":"should throw error if get fails with other error","duration":0,"failureMessages":[]},{"ancestorTitles":["","StoryRepository"],"fullName":" StoryRepository should create a story","status":"passed","title":"should create a story","duration":0,"failureMessages":[]},{"ancestorTitles":["","StoryRepository"],"fullName":" StoryRepository should throw error if create fails","status":"passed","title":"should throw error if create fails","duration":1,"failureMessages":[]},{"ancestorTitles":["","StoryRepository"],"fullName":" StoryRepository should update story status","status":"passed","title":"should update story status","duration":0,"failureMessages":[]},{"ancestorTitles":["","StoryRepository"],"fullName":" StoryRepository should throw error if update status fails","status":"passed","title":"should throw error if update status fails","duration":0,"failureMessages":[]},{"ancestorTitles":["","StoryRepository"],"fullName":" StoryRepository should update story","status":"passed","title":"should update story","duration":0,"failureMessages":[]},{"ancestorTitles":["","StoryRepository"],"fullName":" StoryRepository should throw error if update story fails","status":"passed","title":"should throw error if update story fails","duration":0,"failureMessages":[]}],"startTime":1769146246728,"endTime":1769146246729,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/lib/core/stories/__tests__/repository.test.ts"},{"assertionResults":[{"ancestorTitles":["","tokenizeText"],"fullName":" tokenizeText tokenizes a simple sentence correctly","status":"passed","title":"tokenizes a simple sentence correctly","duration":0,"failureMessages":[]},{"ancestorTitles":["","tokenizeText"],"fullName":" tokenizeText handles multiple spaces between words correctly","status":"passed","title":"handles multiple spaces between words correctly","duration":0,"failureMessages":[]},{"ancestorTitles":["","tokenizeText"],"fullName":" tokenizeText returns an empty array for an empty string","status":"passed","title":"returns an empty array for an empty string","duration":0,"failureMessages":[]},{"ancestorTitles":["","tokenizeText"],"fullName":" tokenizeText returns an empty array for a string with only whitespace","status":"passed","title":"returns an empty array for a string with only whitespace","duration":0,"failureMessages":[]},{"ancestorTitles":["","tokenizeText"],"fullName":" tokenizeText correctly splits punctuation from words in complex sentences","status":"passed","title":"correctly splits punctuation from words in complex sentences","duration":0,"failureMessages":[]}],"startTime":1769146251801,"endTime":1769146251801,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/lib/core/utils/__tests__/tokenization.test.ts"},{"assertionResults":[{"ancestorTitles":["","RewardService"],"fullName":" RewardService should generate the correct claim key for book opened","status":"passed","title":"should generate the correct claim key for book opened","duration":10,"failureMessages":[]},{"ancestorTitles":["","RewardService"],"fullName":" RewardService should handle mission completion with correct key and amount","status":"passed","title":"should handle mission completion with correct key and amount","duration":0,"failureMessages":[]},{"ancestorTitles":["","RewardService"],"fullName":" RewardService should handle already claimed rewards (idempotency)","status":"passed","title":"should handle already claimed rewards (idempotency)","duration":0,"failureMessages":[]},{"ancestorTitles":["","RewardService"],"fullName":" RewardService should handle story generation rewards","status":"passed","title":"should handle story generation rewards","duration":0,"failureMessages":[]},{"ancestorTitles":["","RewardService"],"fullName":" RewardService should handle magic sentence generation rewards","status":"passed","title":"should handle magic sentence generation rewards","duration":0,"failureMessages":[]},{"ancestorTitles":["","RewardService"],"fullName":" RewardService should handle word insight viewing rewards","status":"passed","title":"should handle word insight viewing rewards","duration":0,"failureMessages":[]},{"ancestorTitles":["","RewardService"],"fullName":" RewardService should handle word addition rewards","status":"passed","title":"should handle word addition rewards","duration":1,"failureMessages":[]},{"ancestorTitles":["","RewardService"],"fullName":" RewardService should pass timezone to the RPC","status":"passed","title":"should pass timezone to the RPC","duration":0,"failureMessages":[]}],"startTime":1769146246354,"endTime":1769146246365,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/lib/features/activity/__tests__/reward-service.test.ts"},{"assertionResults":[{"ancestorTitles":["","PollyNarrationService"],"fullName":" PollyNarrationService should synthesize audio successfully","status":"passed","title":"should synthesize audio successfully","duration":0,"failureMessages":[]},{"ancestorTitles":["","PollyNarrationService"],"fullName":" PollyNarrationService should skip speech marks for generative engine","status":"passed","title":"should skip speech marks for generative engine","duration":1,"failureMessages":[]},{"ancestorTitles":["","PollyNarrationService"],"fullName":" PollyNarrationService should throw error if audio stream is missing","status":"passed","title":"should throw error if audio stream is missing","duration":0,"failureMessages":[]}],"startTime":1769146250732,"endTime":1769146250733,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/lib/features/narration/__tests__/narration.service.test.ts"},{"assertionResults":[{"ancestorTitles":["","StoryService"],"fullName":" StoryService generateStory should call the AI provider and return a structured story","status":"passed","title":"generateStory should call the AI provider and return a structured story","duration":0,"failureMessages":[]},{"ancestorTitles":["","StoryService"],"fullName":" StoryService generateStory should propagate errors from the provider","status":"passed","title":"generateStory should propagate errors from the provider","duration":0,"failureMessages":[]}],"startTime":1769146250989,"endTime":1769146250989,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/lib/features/story/__tests__/story.service.test.ts"},{"assertionResults":[{"ancestorTitles":["","GeminiServerProvider"],"fullName":" GeminiServerProvider should analyze word successfully","status":"passed","title":"should analyze word successfully","duration":0,"failureMessages":[]},{"ancestorTitles":["","GeminiServerProvider"],"fullName":" GeminiServerProvider should return empty object on empty response","status":"passed","title":"should return empty object on empty response","duration":0,"failureMessages":[]},{"ancestorTitles":["","MagicSentenceService"],"fullName":" MagicSentenceService should generate magic sentence successfully with image","status":"failed","title":"should generate magic sentence successfully with image","duration":3,"failureMessages":["expected \"spy\" to be called at least once"],"location":{"line":191,"column":28}},{"ancestorTitles":["","MagicSentenceService"],"fullName":" MagicSentenceService should throw forbidden if child not owned by user","status":"passed","title":"should throw forbidden if child not owned by user","duration":0,"failureMessages":[]},{"ancestorTitles":["","MagicSentenceService"],"fullName":" MagicSentenceService should throw limit reached if reservation fails","status":"passed","title":"should throw limit reached if reservation fails","duration":0,"failureMessages":[]}],"startTime":1769146246384,"endTime":1769146246387,"status":"failed","message":"","name":"/Users/renchen/Work/github/raiden/lib/features/word-insight/__tests__/word-insight.service.test.ts"},{"assertionResults":[{"ancestorTitles":["","GeminiNarrationProvider"],"fullName":" GeminiNarrationProvider should initialize with type \"gemini\"","status":"passed","title":"should initialize with type \"gemini\"","duration":0,"failureMessages":[]},{"ancestorTitles":["","GeminiNarrationProvider"],"fullName":" GeminiNarrationProvider should have correct capabilities","status":"passed","title":"should have correct capabilities","duration":0,"failureMessages":[]},{"ancestorTitles":["","GeminiNarrationProvider"],"fullName":" GeminiNarrationProvider should delegate prepare call","status":"passed","title":"should delegate prepare call","duration":0,"failureMessages":[]},{"ancestorTitles":["","GeminiNarrationProvider"],"fullName":" GeminiNarrationProvider should delegate play call","status":"passed","title":"should delegate play call","duration":1,"failureMessages":[]},{"ancestorTitles":["","GeminiNarrationProvider"],"fullName":" GeminiNarrationProvider should delegate pause call","status":"passed","title":"should delegate pause call","duration":0,"failureMessages":[]},{"ancestorTitles":["","GeminiNarrationProvider"],"fullName":" GeminiNarrationProvider should delegate stop call","status":"passed","title":"should delegate stop call","duration":0,"failureMessages":[]},{"ancestorTitles":["","GeminiNarrationProvider"],"fullName":" GeminiNarrationProvider should delegate setPlaybackRate call","status":"passed","title":"should delegate setPlaybackRate call","duration":0,"failureMessages":[]},{"ancestorTitles":["","GeminiNarrationProvider"],"fullName":" GeminiNarrationProvider should delegate getCurrentTimeSec call","status":"passed","title":"should delegate getCurrentTimeSec call","duration":0,"failureMessages":[]},{"ancestorTitles":["","GeminiNarrationProvider"],"fullName":" GeminiNarrationProvider should delegate seekToTime call","status":"passed","title":"should delegate seekToTime call","duration":0,"failureMessages":[]},{"ancestorTitles":["","GeminiNarrationProvider"],"fullName":" GeminiNarrationProvider should delegate on event subscription","status":"passed","title":"should delegate on event subscription","duration":0,"failureMessages":[]}],"startTime":1769146249042,"endTime":1769146249043,"status":"passed","message":"","name":"/Users/renchen/Work/github/raiden/lib/features/narration/implementations/__tests__/gemini-provider.test.ts"}]}
